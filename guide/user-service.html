<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>SecureSocial - Authentication for Play Framework Applications</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="author" content="">
<!-- Le styles --><link media="screen" rel="stylesheet" type="text/css" href="../stylesheets/bootstrap.min.css">
<link media="screen" rel="stylesheet" type="text/css" href="../stylesheets/bootstrap-responsive.min.css">
<link media="screen" rel="stylesheet" type="text/css" href="../stylesheets/pygment.css">
<style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
    </style>
<!-- HTML5 shim, for IE6-8 support of HTML5 elements --><!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>
<body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../">SecureSocial</a>
          <div class="nav-collapse collapse">
            <ul class="nav">
<li><a href="../">Home</a></li>
              <li class="active"><a href="overview.html">User Guide</a></li>
              <li><a href="https://github.com/jaliss/securesocial">View on Github</a></li>                            
            </ul>
</div>
<!--/.nav-collapse -->
        </div>
      </div>
    </div>


    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span3">
          <div class="sidebar-nav">
  <ul class="nav nav-list">
<li class="nav-header">Contents</li>
        
    	<li>
    		<a href="overview.html">Overview</a> 
    	</li>
   	    
    	<li>
    		<a href="installation.html">Installation</a> 
    	</li>
   	    
    	<li>
    		<a href="configuration.html">Configuration</a> 
    	</li>
   	    
    	<li>
    		<a href="securing.html">Securing your Actions</a> 
    	</li>
   	    
    	<li class="active">
    		<a href="user-service.html">UserService</a> 
    	</li>
   	    
    	<li>
    		<a href="views-customization.html">Views and Emails Customization</a> 
    	</li>
   	    
    	<li>
    		<a href="faqs.html">FAQs</a> 
    	</li>
   	    
    	<li>
    		<a href="changelog.html">Change Log</a> 
    	</li>
   	
    </ul>
</div>     
        </div>

        <div class="span9">       
          <section id="overview"><div class="page-header">
              <h1>UserService</h1>

<p>SecureSocial relies on an implementation of <code>UserService</code> to save/find users. Using this delegation model you are not forced to use a particular model object but rather provide a service that translates back and forth between your models and what SecureSocial understans. </p>

<p>Besides users, this service is also in charge of persisting the tokens that are used in signup and reset password requests. Some of these methods are only required if you are going to use the <code>UsernamePasswordProvider</code>. If you do not plan to use it just provide an empty implementation for them.  Check the documentation in the source code to know which ones are optional.</p>

<p>For Scala you need to extend the <code>UserServicePlugin</code>. For example:</p>

<div class="highlight"><pre><span class="k">class</span> <span class="nc">MyUserService</span><span class="o">(</span><span class="n">application</span><span class="k">:</span> <span class="kt">Application</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">UserServicePlugin</span><span class="o">(</span><span class="n">application</span><span class="o">)</span> <span class="o">{</span>
  <span class="cm">/**</span>
<span class="cm">   * Finds a SocialUser that maches the specified id</span>
<span class="cm">   *</span>
<span class="cm">   * @param id the user id</span>
<span class="cm">   * @return an optional user</span>
<span class="cm">   */</span>
  <span class="k">def</span> <span class="n">find</span><span class="o">(</span><span class="n">id</span><span class="k">:</span> <span class="kt">UserId</span><span class="o">)</span><span class="k">:</span><span class="kt">Option</span><span class="o">[</span><span class="kt">SocialUser</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
    <span class="c1">// implement me</span>
  <span class="o">}</span>

  <span class="cm">/**</span>
<span class="cm">   * Finds a Social user by email and provider id.</span>
<span class="cm">   *</span>
<span class="cm">   * Note: If you do not plan to use the UsernamePassword provider just provide en empty</span>
<span class="cm">   * implementation.</span>
<span class="cm">   *</span>
<span class="cm">   * @param email - the user email</span>
<span class="cm">   * @param providerId - the provider id</span>
<span class="cm">   * @return</span>
<span class="cm">   */</span>
  <span class="k">def</span> <span class="n">findByEmail</span><span class="o">(</span><span class="n">email</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">providerId</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span><span class="kt">Option</span><span class="o">[</span><span class="kt">SocialUser</span><span class="o">]</span> <span class="k">=</span>
  <span class="o">{</span>
    <span class="c1">// implement me</span>
  <span class="o">}</span>

  <span class="cm">/**</span>
<span class="cm">   * Saves the user.  This method gets called when a user logs in.</span>
<span class="cm">   * This is your chance to save the user information in your backing store.</span>
<span class="cm">   * @param user</span>
<span class="cm">   */</span>
  <span class="k">def</span> <span class="n">save</span><span class="o">(</span><span class="n">user</span><span class="k">:</span> <span class="kt">SocialUser</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// implement me</span>
  <span class="o">}</span>

  <span class="cm">/**</span>
<span class="cm">   * Saves a token.  This is needed for users that</span>
<span class="cm">   * are creating an account in the system instead of using one in a 3rd party system.</span>
<span class="cm">   *</span>
<span class="cm">   * Note: If you do not plan to use the UsernamePassword provider just provide en empty</span>
<span class="cm">   * implementation</span>
<span class="cm">   *</span>
<span class="cm">   * @param token The token to save</span>
<span class="cm">   * @return A string with a uuid that will be embedded in the welcome email.</span>
<span class="cm">   */</span>
  <span class="k">def</span> <span class="n">save</span><span class="o">(</span><span class="n">token</span><span class="k">:</span> <span class="kt">Token</span><span class="o">)</span> <span class="k">=</span> <span class="o">{</span>
    <span class="c1">// implement me</span>
  <span class="o">}</span>


  <span class="cm">/**</span>
<span class="cm">   * Finds a token</span>
<span class="cm">   *</span>
<span class="cm">   * Note: If you do not plan to use the UsernamePassword provider just provide en empty</span>
<span class="cm">   * implementation</span>
<span class="cm">   *</span>
<span class="cm">   * @param token the token id</span>
<span class="cm">   * @return</span>
<span class="cm">   */</span>
  <span class="k">def</span> <span class="n">findToken</span><span class="o">(</span><span class="n">token</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Token</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
    <span class="c1">// implement me</span>
  <span class="o">}</span>

  <span class="cm">/**</span>
<span class="cm">   * Deletes a token</span>
<span class="cm">   *</span>
<span class="cm">   * Note: If you do not plan to use the UsernamePassword provider just provide en empty</span>
<span class="cm">   * implementation</span>
<span class="cm">   *</span>
<span class="cm">   * @param uuid the token id</span>
<span class="cm">   */</span>
  <span class="k">def</span> <span class="n">deleteToken</span><span class="o">(</span><span class="n">uuid</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// implement me</span>
  <span class="o">}</span>

  <span class="cm">/**</span>
<span class="cm">   * Deletes all expired tokens</span>
<span class="cm">   *</span>
<span class="cm">   * Note: If you do not plan to use the UsernamePassword provider just provide en empty</span>
<span class="cm">   * implementation</span>
<span class="cm">   *</span>
<span class="cm">   */</span>
  <span class="k">def</span> <span class="n">deleteExpiredTokens</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// implement me</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>

<p>For Java, you need to extend the <code>BaseUserService</code> class.</p>

<div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyUserService</span> <span class="kd">extends</span> <span class="n">BaseUserService</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="nf">MyUserService</span><span class="o">(</span><span class="n">Application</span> <span class="n">application</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">application</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doSave</span><span class="o">(</span><span class="n">SocialUser</span> <span class="n">user</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// implement me</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doSave</span><span class="o">(</span><span class="n">Token</span> <span class="n">token</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// implement me</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">SocialUser</span> <span class="nf">doFind</span><span class="o">(</span><span class="n">UserId</span> <span class="n">userId</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// implement me</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Token</span> <span class="nf">doFindToken</span><span class="o">(</span><span class="n">String</span> <span class="n">tokenId</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// implement me</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">SocialUser</span> <span class="nf">doFindByEmail</span><span class="o">(</span><span class="n">String</span> <span class="n">email</span><span class="o">,</span> <span class="n">String</span> <span class="n">providerId</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// implement me</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doDeleteToken</span><span class="o">(</span><span class="n">String</span> <span class="n">uuid</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// implement me</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doDeleteExpiredTokens</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// implement me</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>

<p><em>Note: the Scala and Java samples come with a memory based implementation that can be used as a starting point for your own implementation.</em></p>

<h1>Important</h1>

<p>You'll notice that some class names in the Scala and Java samples are the same but they are actually different classes residing in separate packages.  Check the <code>securesocial.core.java</code> package for the Java ones.</p>

<p>SecureSocial provides the same objects in Java and Scala implementations and converts automatically between them behind the scenes so you only deal with the language you need.</p>

            </div>
          </section>
</div>
      </div>
    </div>
    <footer style="padding: 30px 0;margin-top: 70px;border-top: 1px solid #E5E5E5;background-color: whiteSmoke;"><div class="container">
		<p> <a href="https://github.com/jaliss/securesocial">View on Github</a></p>        
        <p>Designed and developed by <a href="http://twitter.com/jaliss" target="_blank">@jaliss</a>.</p>
        <p>Code licensed under <a href="http://www.apache.org/licenses/LICENSE-2.0" target="_blank">Apache License v2.0</a>, documentation under <a href="http://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>.</p>
        <p>© 2011-2012 Jorge Aliss       
    </p>
</div>
       
</footer><script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-1441023-12']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>
